#Stage 1
loot spawn -333 229 98 loot library:stage/pos
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:1}}}] run summon panda -340 230 98 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:2}}}] run summon panda -335 230 92 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:3}}}] run summon panda -328 230 94 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:4}}}] run summon panda -328 230 102 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:5}}}] run summon panda -335 230 104 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}
execute at @e[limit=1,name="M@K",tag=mg-1] if entity @e[type=item,nbt={Item:{tag:{rl:6}}}] run summon panda -333 230 98 {Team:mg-1,Passengers:[{id:armor_stand,Count:1,Invisible:1,Small:1,Tags:[n,nb]}],Rotation:[-90f],Tags:[p0ly,"6",b0ss,mg-1],ActiveEffects:[{Id:11b,Duration:999,ShowParticles:0b,Amplifier:255}],Motion:[0d,0.1d,0d],HandItems:[{id:bamboo,Count:1,tag:{0:1}}],Attributes:[{Base:0d,Name:generic.movementSpeed}],DeathLootTable:""}

#Stage2
data merge entity @e[tag=b0ss,limit=1] {Invulnerable:0b}
execute as @e[tag=n] at @s if entity @e[tag=b0ss,tag=!0,limit=1,distance=..2] run tag @s add nb
execute as @e[tag=nb] at @s if entity @e[tag=b0ss,limit=1,distance=..2] if score @e[limit=1,name="M@K",tag=!mg-1s] mg-1 matches 15..45 if predicate 25-75 unless block ~ ~-1 ~ chiseled_stone_bricks run data merge entity @s {CustomName:'{"text":"You can\'t catch me!","bold":true}',CustomNameVisible:1}
execute as @e[tag=nb] at @s if entity @e[tag=b0ss,limit=1,distance=..2] if score @e[limit=1,name="M@K",tag=mg-1s] mg-1 matches 94..200 if predicate 25-75 unless block ~ ~-1 ~ chiseled_stone_bricks run data merge entity @s {CustomName:'{"text":"You can\'t catch me!","bold":true}',CustomNameVisible:1}
execute unless entity @s[tag=mg-1s] if entity @e[limit=1,name="M@K",tag=mg-1s] if entity @e[type=item,nbt={Item:{tag:{rl:1}}}] run tag @s add st0p
execute unless entity @s[tag=mg-1s] if entity @e[limit=1,name="M@K",tag=mg-1s] if entity @e[type=item,nbt={Item:{tag:{rl:2}}}] run tag @s add st0p
execute if entity @s[tag=mg-1s] if entity @e[type=item,nbt={Item:{tag:{rl:1}}}] run tag @s add mg-1re
execute if entity @s[tag=mg-1s] if entity @e[type=item,nbt={Item:{tag:{rl:2}}}] run tag @s add mg-1re
execute unless entity @s[tag=mg-1s] as @e[tag=b0ss,tag=p0ly,tag=mg-1] at @s run tp @s ~ ~ ~ facing entity @p[tag=mg-1,tag=XPplayers]
execute at @s[tag=st0p] run function library:stage/shoot
execute if entity @e[limit=1,name="M@K",scores={mg-1=155..}] as @e[tag=nb] at @s if entity @e[tag=p0ly,tag=b0ss,distance=..2] run data merge entity @s {CustomName:'{"text":""}',CustomNameVisible:0}
execute unless entity @s[tag=mg-1s] if entity @e[limit=1,name="M@K",scores={mg-1=455..},tag=mg-1s] if block ~ ~-2 ~ chiseled_stone_bricks as @e[tag=n] at @s if entity @e[tag=p0ly,tag=b0ss,distance=..2] run data merge entity @s {CustomName:'{"text":""}',CustomNameVisible:0}
tag @s remove st0p